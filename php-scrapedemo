<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
<?php

require '/kint/Kint.class.php';

//$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.TacPage?sl=R&app=9&p_dir=&p_rloc=&p_tloc=&p_ploc=&pg=1&p_tac=&ti=22&pt=8&ch=153&rl=1');
//$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.TacPage?sl=T&app=9&p_dir=N&p_rloc=173354&p_tloc=&p_ploc=1&pg=2&p_tac=&ti=22&pt=8&ch=153&rl=1');
//$dom = new DOMDocument();
//libxml_use_internal_errors(TRUE);
//$dom->loadHTML($html);
//$xpath = new DOMXPath($dom);
//$nodes = $xpath->query('/html/body/table[2]/tr[2]/td/ss');
//foreach ($nodes as $node) {
//    echo $node->textContent . "<br />";
//}

//$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.TacPage?sl=T&app=9&p_dir=N&p_rloc=168949&p_tloc=&p_ploc=1&pg=3&p_tac=&ti=22&pt=8&ch=153&rl=1');
//$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.TacPage?sl=T&app=9&p_dir=N&p_rloc=170540&p_tloc=&p_ploc=1&pg=4&p_tac=&ti=22&pt=8&ch=153&rl=1');
$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.TacPage?sl=T&app=9&p_dir=N&p_rloc=168951&p_tloc=&p_ploc=1&pg=5&p_tac=&ti=22&pt=8&ch=153&rl=1');
$html = str_replace("\n", "", $html);
$dom = new DOMDocument();
libxml_use_internal_errors(TRUE);
$dom->loadHTML($html);
$xpath = new DOMXPath($dom);
$nodes = $xpath->query('/html/body/table[2]/tr[2]/td/ss');
foreach ($nodes as $node) {
//    echo $node->firstChild->childNodes->length . "<br />";
//    echo $node->textContent . "<br />";
    if ($node->firstChild->childNodes->length > 1) {
        foreach ($node->firstChild->childNodes as $node2) {
            if (($node2->childNodes != null) && ($node2->childNodes->length > 1)) {
                foreach ($node2->childNodes as $node3) {
                    if (($node3->childNodes != null) && ($node3->childNodes->length > 1)) {
                        foreach ($node3->childNodes as $node4) {
                            echo "<p style='margin-left: 30px;'>" . trim($node4->nodeValue, chr(0xC2).chr(0xA0)) . "</p>";
                        }
                    }
                    else {
                        if ($node3->nodeName != '#text')
                        {
                            echo "<p style='margin-left: 20px;'>" . trim($node3->nodeValue, chr(0xC2).chr(0xA0)) . "</p>";
                        }
                    }
                }
            }
            else {
                echo "<p style='margin-left: 10px;'>" . $node2->nodeValue . "</p>";
            }
        }
    }
    else {
        echo "<p>" . $node->firstChild->firstChild->nodeValue . "</p>";
    }
//    foreach ($node->firstChild->childNodes as $node2) {
//        echo $node2->childNodes->length . "<br />";
//        echo $node2->nodeValue . "<br />";
//    }
}

die;

?>
</body>
</html>


//$html = file_get_contents('http://texreg.sos.state.tx.us/public/readtac$ext.ViewTAC?tac_view=3&ti=22&pt=8');
//$rules = new DOMDocument();
//libxml_use_internal_errors(TRUE); //disable libxml errors
//
//if(!empty($html)){ //if any html is actually returned
//
//    $rules->loadHTML($html);
//    libxml_clear_errors(); //remove errors for yucky html
//
//    $xpath = new DOMXPath($rules);
//
//    //get all the h2's with an id
//    $nodes = $xpath->query('/html/body/center[2]/table[3]//a/@href');
//
//    $count = 0;
//    if ($nodes->length > 0) {
//        foreach ($nodes as $node) {
//            if ($count % 2 == 0)
//            {
//                $html = file_get_contents('http://texreg.sos.state.tx.us/public/' . $node->nodeValue);
//                $dom = new DOMDocument();
//                $dom->loadHTML($html);
//                libxml_clear_errors(); //remove errors for yucky html
//                $xpath2 = new DOMXPath($dom);
//                $nodes2 = $xpath2->query('/html/body/center[2]/table[3]//a/@href');
//                foreach ($nodes2 as $node2) {
//                    echo $node2->nodeValue . "\n";
//                }
//            }
//            $count++;
//        }
//    }
//}
